<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Jumble Answer - JumbleAnswers.com</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="/src/styles.css" />
  </head>
  <body class="bg-white text-gray-800">
    <header class="bg-[#f8f9fa] border-b">
      <div class="container mx-auto px-4 py-6">
        <div class="flex items-center justify-between">
          <div class="flex items-center gap-4">
            <a href="/" class="text-3xl font-bold text-[#0275d8] hover:opacity-80">JumbleAnswers.com</a>
          </div>
        </div>
      </div>
    </header>

    <main class="container mx-auto px-4 py-8">
      <div class="grid md:grid-cols-3 gap-8">
        <div class="md:col-span-2">
          <div class="bg-white rounded-lg overflow-hidden">
            <div class="bg-[#0275d8] text-white p-4 text-xl">
              Jumble Answer
            </div>
            <div class="p-8 space-y-6 border-x border-b">
              <div id="answer-container" class="text-center">
                <div class="mb-8">
                  <h2 class="text-xl font-semibold text-gray-600 mb-2">Jumbled Word:</h2>
                  <p id="jumbled-word" class="text-4xl font-bold text-[#0275d8]"></p>
                </div>
                <div class="relative">
                  <div class="absolute inset-0 flex items-center">
                    <div class="w-full border-t border-gray-300"></div>
                  </div>
                  <div class="relative flex justify-center">
                    <span class="bg-white px-4 text-sm text-gray-500">UNSCRAMBLES TO</span>
                  </div>
                </div>
                <div class="mt-8">
                  <h2 class="text-xl font-semibold text-gray-600 mb-2">Answer:</h2>
                  <p id="answer" class="text-5xl font-bold text-green-600"></p>
                </div>
                <div id="puzzle-info" class="mt-8 text-left">
                  <h3 class="text-lg font-semibold text-gray-600 mb-2">From Puzzle:</h3>
                  <p id="puzzle-date" class="text-gray-600"></p>
                  <p id="puzzle-caption" class="text-[#0275d8] mt-2"></p>
                </div>
              </div>
              <div class="text-center mt-8">
                <a href="/" class="inline-block bg-[#0275d8] text-white px-6 py-3 rounded hover:bg-[#025aa5] transition-colors">
                  Back to Daily Puzzle
                </a>
              </div>
            </div>
          </div>
        </div>
        
        <div class="md:col-span-1">
          <div class="bg-white rounded-lg overflow-hidden mb-8">
            <div class="bg-gray-100 p-4">
              <h2 class="text-xl font-bold text-gray-800">About the Game</h2>
            </div>
            <div class="p-4">
              <p class="text-gray-600">
                Daily Jumble is one of the most popular word games which has maintained top rankings on both iOS and Android stores and the web. In case you haven't downloaded yet the game and would like to do so you can click the respective images below and you will be redirected to the download page.
              </p>
            </div>
          </div>
        </div>
      </div>
    </main>

    <script>
      document.addEventListener('DOMContentLoaded', async () => {
        const params = new URLSearchParams(window.location.search);
        const word = params.get('word')?.toUpperCase();
        
        if (!word) {
          document.getElementById('answer').textContent = 'No word provided';
          return;
        }

        try {
          const response = await fetch(`https://jznccczfjmatdxdrvszk.supabase.co/functions/v1/get-jumble?word=${word}`);
          const data = await response.json();
          
          if (response.ok) {
            document.getElementById('jumbled-word').textContent = data.jumbled_word;
            document.getElementById('answer').textContent = data.answer;
            
            if (data.daily_puzzles) {
              const puzzleDate = new Date(data.daily_puzzles.date);
              // Ensure the date is interpreted in the local timezone
              puzzleDate.setMinutes(puzzleDate.getMinutes() + puzzleDate.getTimezoneOffset());
              
              document.getElementById('puzzle-date').textContent = puzzleDate.toLocaleDateString('en-US', {
                weekday: 'long',
                year: 'numeric',
                month: 'long',
                day: 'numeric'
              });
              document.getElementById('puzzle-caption').textContent = data.daily_puzzles.caption;
            }
            
            // Update page title
            document.title = `${data.jumbled_word} - JumbleAnswers.com`;
          } else {
            document.getElementById('answer').textContent = data.error || 'Word not found';
          }
        } catch (error) {
          console.error('Error fetching answer:', error);
          document.getElementById('answer').textContent = 'Error fetching answer';
        }
      });
    </script>
  </body>
</html>